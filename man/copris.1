.\" Automatically generated by Pandoc 2.19.2
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "COPRIS" "1" "2023-02-22" "" "0.9-495-g91fbff5-dirty"
.hy
.SH NAME
.PP
\f[B]copris\f[R] - a converting printer server
.SH SYNOPSIS
.PP
\f[B]copris\f[R] [\f[I]options\f[R]] [\f[I]printer\f[R] or \f[I]output
file\f[R]]
.PD 0
.P
.PD
\f[B]copris\f[R] \f[B]--dump-commands\f[R] > new_printer_set.ini
.SH DESCRIPTION
.PP
COPRIS is a printer server and text conversion program, intended to
receive UTF-8 encoded text locally or over a network, process it and
send it to a dot-matrix printer.
In its core, COPRIS reads text from standard input or a built-in TCP
socket server (similar to \f[V]telnet(1)\f[R] or \f[V]nc(1)\f[R]), and
optionally applies two processing methods to it:
.SS Character translation
.PP
COPRIS can load a \f[I]translation file\f[R] that defines user-specified
characters, not understood by printers - usually multi-byte (UTF-8)
ones.
They are swapped with appropriate (or at least similar) locale-specific
replacements, defined in the same file.
.SS Printer feature sets
.PP
While COPRIS processes only plain text, some additional markup can be
applied to it via \f[I]printer feature set files\f[R].
These may specify printer\[cq]s escape codes for attributes, such as
bold, italic, double-width text, they may change font faces, sizes,
spacing and so on.
COPRIS searches for a subset of Markdown attributes, present in input
text, and replaces them with printer\[cq]s escape codes, much the same
as with translation files.
.SS File format
.PP
\f[I]Translation\f[R] and \f[I]printer feature set files\f[R] are
expected to be in the INI file format:
.IP
.nf
\f[C]
# Comment
[section]
key = whitespace separated values ; inline comment
\f[R]
.fi
.PP
In case you need a \f[V]key\f[R] to resolve to a blank value, set
\f[V]\[at]\f[R] as the value (e.g.\ if you want to remove instead of
replace certain characters in the text, or omit rendering some Markdown
attributes).
.SH OPTIONS
.TP
\f[B]-p\f[R], \f[B]--port\f[R] \f[I]NUMBER\f[R]
Run COPRIS as a network server on port \f[I]NUMBER\f[R].
Superuser privileges are required if \f[I]NUMBER\f[R] is less than 1024.
.TP
\f[B]-t\f[R], \f[B]--translate\f[R] \f[I]FILE\f[R]
Enable character translation with definitions from character translation
\f[I]FILE\f[R].
.TP
\f[B]-r\f[R], \f[B]--printer\f[R] \f[I]FILE\f[R]
Enable Markdown parsing with definitions from printer feature set
\f[I]FILE\f[R].
.TP
\f[B]--dump-commands\f[R]
Show all possible printer feature set commands in INI file format
(e.g.\ to be piped into a new printer feature set file you are making).
.TP
\f[B]-d\f[R], \f[B]--daemon\f[R]
If running as a network server, do not exit after the first connection.
.TP
\f[B]-l\f[R], \f[B]--limit\f[R] \f[I]NUMBER\f[R]
If running as a network server, limit number of received bytes to
\f[I]NUMBER\f[R].
.TP
\f[B]--cutoff-limit\f[R]
If limit is active, cut text on \f[I]NUMBER\f[R] count instead of
discarding the whole chunk.
.TP
\f[B]-R\f[R], \f[B]--remove-non-ascii\f[R]
Remove all characters (or bytes) that aren\[cq]t part of the ASCII
character set.
As (old) dot-matrix printers generally don\[cq]t support Unicode-encoded
characters, this will both prevent them being wrongly printed, but at
the same time possibly corrupt the meaning of the text.
.TP
\f[B]-v\f[R], \f[B]--verbose\f[R]
Show informative status messages.
If specified twice, show even more messages.
.TP
\f[B]-q\f[R], \f[B]--quiet\f[R]
Do not show any unneccessary messages, except warnings and fatal errors,
routed to \f[I]stderr\f[R].
This also omits \f[I]notes\f[R], shown if COPRIS assumes it is not
invoked properly.
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Show a short option summary.
.TP
\f[B]-V\f[R], \f[B]--version\f[R]
Show program version, author and build-time options.
.PP
Do not specify a port number if you want to read from standard input.
Likewise, omit the output file to have text echoed out to standard
output (or piped elsewhere).
.SH EXAMPLES
.PP
Run as a simple server on port 8080, perform no text conversion, output
received data to the serial port and exit after one connection.
Note that superuser privileges are required if the specified port is
smaller than 1024.
.IP
.nf
\f[C]
copris -p 8080 /dev/ttyS0
\f[R]
.fi
.PP
Serve on port 8080 as a daemon (do not exit after first connection),
translate characters using the \f[V]slovene.ini\f[R] translation file,
limit any incoming text to maximum 100 characters and print received
data to the terminal.
Note that text limit works only when running as a server.
.IP
.nf
\f[C]
copris -p 8080 -d -t slovene.ini -l 100
\f[R]
.fi
.PP
Read local file \f[V]Manual.md\f[R] using the specified printer feature
set \f[V]epson.ini\f[R] and output formatted text to a USB interface on
the local computer:
.IP
.nf
\f[C]
copris -r epson.ini /dev/ttyUSB0 < Manual.md
\f[R]
.fi
.SH FILES
.PP
Example translation and printer feature set files can be found in
\f[V]/usr/share/copris\f[R].
.SH DEVELOPMENT
.PP
COPRIS\[cq] development repository resides at
<https://github.com/bertronika/copris>.
